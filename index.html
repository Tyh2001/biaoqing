<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Tyh.表情发布系统</title>
  <link rel="icon"
    href="http://r.photo.store.qq.com/psc?/V52OzcjM296N4D3IEo5e1DfOQZ1pM1IO/45NBuzDIW489QBoVep5mcbbCgPFd9Kpgzz8mrSV9Syf7z9nyl1g3GYE4qN.RDQN4qa6.Wrf6L306eRGIvPYtnJB750JD6L*.V5joZLRlJpc!/r">
  <link rel="stylesheet" href="./css/index.css">
</head>

<body>
  <div class="box">
    <div class="myWeb">
      <a href="http://tianyuhao.icu/#/">
        个人网站首页
        <img src="./images/转发.svg" alt="转发">
      </a>
      <a href="http://toutiaopc.tianyuhao.icu/#/">
        文章发布后台管理系统
        <img src="./images/转发.svg" alt="转发">
      </a>
      <a href="http://toutiaope.tianyuhao.icu/#/">
        头条移动端
        <img src="./images/转发.svg" alt="转发">
      </a>
    </div>
    <h3 class="title">Tyh. 模拟表情发布系统 3.0版</h3>
    <textarea id="textarea" placeholder="今天有什么想说的？" maxlength="399"></textarea>
    <!-- 菜单栏 -->
    <div class="menuBar">
      <input type="file" id="file" multiple accept="image/*" hidden>

      <!-- 添加图片按钮 -->
      <div class="addImg">
        <img class="addImg" src="./images/addimg.svg">
        <span>添加图片</span>
      </div>

      <!-- 发布按钮 -->
      <button class="release-btn">发布</button>
    </div>

    <!-- 预览图片的列表 -->
    <div class="previewPicturesBox"></div>

    <!-- 表情列表 -->
    <div class="AddEmoticonsBox">
      <div class="top">
        <span class="wordsSwitch" style="color: #ff8140;">emoji表情</span>
        <span class="wordsSwitch">QQ表情</span>
        <span class="wordsSwitch">颜文字</span>
      </div>
      <!-- emoji 表情 -->
      <div class="expressionMenu" style="display: block;">
        <ul>
          <li class="emojeLi" alt="[em_1]" title="高兴">
            <img src="表情/emoji表情/1.png">
          </li>
          <li class="emojeLi" alt="[em_2]" title="大哭">
            <img src="表情/emoji表情/2.png">
          </li>
          <li class="emojeLi" alt="[em_3]" title="紧张">
            <img src="表情/emoji表情/3.png">
          </li>
          <li class="emojeLi" alt="[em_4]" title="可爱">
            <img src="表情/emoji表情/4.png">
          </li>
          <li class="emojeLi" alt="[em_5]" title="亲亲">
            <img src="表情/emoji表情/5.png">
          </li>
          <li class="emojeLi" alt="[em_6]" title="生气">
            <img src="表情/emoji表情/6.png">
          </li>
          <li class="emojeLi" alt="[em_7]" title="淘气">
            <img src="表情/emoji表情/7.png">
          </li>
          <li class="emojeLi" alt="[em_8]" title="难受">
            <img src="表情/emoji表情/8.png">
          </li>
          <li class="emojeLi" alt="[em_9]" title="呲牙">
            <img src="表情/emoji表情/9.png">
          </li>
          <li class="emojeLi" alt="[em_10]" title="笑哭">
            <img src="表情/emoji表情/10.png">
          </li>
          <li class="emojeLi" alt="[em_11]" title="色">
            <img src="表情/emoji表情/11.png">
          </li>
          <li class="emojeLi" alt="[em_12]" title="忧愁">
            <img src="表情/emoji表情/12.png">
          </li>
          <li class="emojeLi" alt="[em_13]" title="飞吻">
            <img src="表情/emoji表情/13.png">
          </li>
          <li class="emojeLi" alt="[em_14]" title="失落">
            <img src="表情/emoji表情/14.png">
          </li>
          <li class="emojeLi" alt="[em_15]" title="害怕">
            <img src="表情/emoji表情/15.png">
          </li>
          <li class="emojeLi" alt="[em_16]" title="恐惧">
            <img src="表情/emoji表情/16.png">
          </li>
          <li class="emojeLi" alt="[em_17]" title="不屑">
            <img src="表情/emoji表情/17.png">
          </li>
          <li class="emojeLi" alt="[em_18]" title="冒金星">
            <img src="表情/emoji表情/18.png">
          </li>
          <li class="emojeLi" alt="[em_19]" title="哼哼">
            <img src="表情/emoji表情/19.png">
          </li>
          <li class="emojeLi" alt="[em_20]" title="汗">
            <img src="表情/emoji表情/20.png">
          </li>

        </ul>
      </div>

      <!-- QQ 表情 -->
      <div class="expressionMenu">
        <ul>
          <li class="QQLi" alt="[qq_1]" title="微笑">
            <img src="表情/QQ表情/1.gif">
          </li>
          <li class="QQLi" alt="[qq_2]" title="撇嘴">
            <img src="表情/QQ表情/2.gif">
          </li>
          <li class="QQLi" alt="[qq_3]" title="色">
            <img src="表情/QQ表情/3.gif">
          </li>
          <li class="QQLi" alt="[qq_4]" title="发呆">
            <img src="表情/QQ表情/4.gif">
          </li>
          <li class="QQLi" alt="[qq_5]" title="流泪">
            <img src="表情/QQ表情/5.gif">
          </li>
          <li class="QQLi" alt="[qq_6]" title="害羞">
            <img src="表情/QQ表情/6.gif">
          </li>
          <li class="QQLi" alt="[qq_7]" title="闭嘴">
            <img src="表情/QQ表情/7.gif">
          </li>
          <li class="QQLi" alt="[qq_8]" title="睡">
            <img src="表情/QQ表情/8.gif">
          </li>
          <li class="QQLi" alt="[qq_9]" title="大哭">
            <img src="表情/QQ表情/9.gif">
          </li>
          <li class="QQLi" alt="[qq_10]" title="尴尬">
            <img src="表情/QQ表情/10.gif">
          </li>
          <li class="QQLi" alt="[qq_11]" title="发怒">
            <img src="表情/QQ表情/11.gif">
          </li>
          <li class="QQLi" alt="[qq_12]" title="调皮">
            <img src="表情/QQ表情/12.gif">
          </li>
          <li class="QQLi" alt="[qq_13]" title="呲牙">
            <img src="表情/QQ表情/13.gif">
          </li>
          <li class="QQLi" alt="[qq_14]" title="惊讶">
            <img src="表情/QQ表情/14.gif">
          </li>
          <li class="QQLi" alt="[qq_15]" title="难过">
            <img src="表情/QQ表情/15.gif">
          </li>
          <li class="QQLi" alt="[qq_16]" title="冷汗">
            <img src="表情/QQ表情/16.gif">
          </li>
          <li class="QQLi" alt="[qq_17]" title="抓狂">
            <img src="表情/QQ表情/17.gif">
          </li>
          <li class="QQLi" alt="[qq_18]" title="吐">
            <img src="表情/QQ表情/18.gif">
          </li>
          <li class="QQLi" alt="[qq_19]" title="偷笑">
            <img src="表情/QQ表情/19.gif">
          </li>
          <li class="QQLi" alt="[qq_20]" title="可爱">
            <img src="表情/QQ表情/20.gif">
          </li>
          <li class="QQLi" alt="[qq_21]" title="白眼">
            <img src="表情/QQ表情/21.gif">
          </li>
          <li class="QQLi" alt="[qq_22]" title="傲慢">
            <img src="表情/QQ表情/22.gif">
          </li>
          <li class="QQLi" alt="[qq_23]" title="饥饿">
            <img src="表情/QQ表情/23.gif">
          </li>
          <li class="QQLi" alt="[qq_24]" title="困">
            <img src="表情/QQ表情/24.gif">
          </li>
        </ul>
      </div>

      <!-- 颜文字 -->
      <div class="expressionMenu">
        <ul>
          <li class="Emoticons">(*^▽^*)</li>
          <li class="Emoticons">(^_−)☆</li>
          <li class="Emoticons">o(´^｀)o</li>
          <li class="Emoticons">o(╥﹏╥)o</li>
          <li class="Emoticons">→_→</li>
          <li class="Emoticons">ψ(｀ー´)ψ</li>
          <li class="Emoticons">(•́へ•́╬)</li>
          <li class="Emoticons">(ー_ー)</li>
          <li class="Emoticons">|ू･ω･` )</li>
          <li class="Emoticons">(✪ω✪)</li>
          <li class="Emoticons">(ಥ_ಥ)</li>
          <li class="Emoticons">┗( ▔, ▔ )┛</li>
          <li class="Emoticons">(‾◡◝)</li>
          <li class="Emoticons">(≧∇≦)ﾉ</li>
          <li class="Emoticons">(❁´◡`❁)</li>
          <li class="Emoticons">(*＾-＾*)</li>
          <li class="Emoticons">(*^_^*)</li>
          <li class="Emoticons">`(*>﹏0*)′</li>
          <li class="Emoticons">(✿◡‿◡)</li>
          <li class="Emoticons">O(∩_∩)O</li>
          <li class="Emoticons">( •̀ ω •́ )✧</li>
          <li class="Emoticons">0.0</li>
          <li class="Emoticons">-.-</li>
          <li class="Emoticons">ƪ(˘⌣˘)ʃ</li>
        </ul>
      </div>
    </div>

    <!-- 展示内容 -->
    <h4>你发布的内容是：</h4>
    <ol class="testBoxTitle"></ol>
  </div>

  <script src="Js/My_jQ.js"></script>
  <script>
    // 表情菜单切换选项卡
    let wordsSwitch = $Al(".wordsSwitch");
    let expressionMenu = $Al(".expressionMenu");
    for (let i = 0; i < expressionMenu.length; i++) {
      wordsSwitch[i].onclick = function () {
        for (let j = 0; j < expressionMenu.length; j++) {
          expressionMenu[j].style.display = "none";
          wordsSwitch[j].style.color = "black";
        }
        expressionMenu[i].style.display = "block";
        wordsSwitch[i].style.color = "#ff8140";
      }
    }

    // 添加颜文字表情
    let Emoticons = $Al(".Emoticons");
    for (let i = 0; i < Emoticons.length; i++) {
      Emoticons[i].onclick = function () {
        $D("textarea").value += ` ${Emoticons[i].innerHTML} `;
      }
    }

    // 添加Emoje表情
    let emojeLi = $Al(".emojeLi");
    for (let i = 0; i < emojeLi.length; i++) {
      emojeLi[i].onclick = function () {
        // 获取到点击表情的 alt 属性 并且加到文本框内
        const emojeLiAlt = emojeLi[i].getAttribute("alt");
        $D("textarea").value += emojeLiAlt;
      }
    }

    // 添加QQ表情
    let QQLi = $Al(".QQLi");
    for (let i = 0; i < QQLi.length; i++) {
      QQLi[i].onclick = function () {
        const QQLiAlt = QQLi[i].getAttribute("alt");
        $D("textarea").value += QQLiAlt;
      }
    }

    // 表情转换
    function transformation(str) {
      str = str.replace(/\[em_([0-9]*)\]/g, "<img src='表情/emoji表情/$1.png'>");
      str = str.replace(/\[qq_([0-9]*)\]/g, "<img src='表情/QQ表情/$1.gif'>");
      return str;
    }

    // 将选择的图片添加到容器中
    let file = $D("file"); // file input
    let previewPicturesBox = $(".previewPicturesBox"); // 装图片的容器

    $(".addImg").onclick = function () {
      file.click()
      // 当文本框发生变化时候
      file.onchange = function () {
        let fileLength = file.files.length; // 获取到上传文件的数组的长度
        for (let i = 0; i < fileLength; i++) {
          const blogImg = window.URL.createObjectURL(file.files[i]);
          let previewPictures = document.createElement("img"); // 新建一个 img 标签
          previewPictures.src = blogImg;
          previewPictures.setAttribute("class", "previewPicturesTop");
          previewPicturesBox.appendChild(previewPictures);
        }
      }
    }

    // 点击发布按钮
    $(".release-btn").onclick = function () {
      if ($D("textarea").value === "") {
        alert("内容为空不能发表！")
      } else {

        const newLi = document.createElement("li"); // 新建一个 li 标签

        // 表情替换 点击发布将表情添加到列表中
        let textareaVal = $D("textarea").value;
        textareaVal = transformation(textareaVal);
        let divContent = document.createElement("div"); // 新建一个 div 标签
        divContent.innerHTML = textareaVal
        newLi.appendChild(divContent);

        // 获取选择上传的图片 添加到列表中
        let previewPicturesImg = $Al(".previewPicturesTop"); // 获取到所有的需要上传的图片
        for (let i = 0; i < previewPicturesImg.length; i++) {
          let previewPicturesSrc = previewPicturesImg[i].getAttribute("src"); // 获取到每个需要上传图片的 Src属性值
          let blogImgBoxImg = document.createElement("img"); // 新建一个 img 标签
          blogImgBoxImg.setAttribute("src", previewPicturesSrc);
          blogImgBoxImg.setAttribute("class", "previewPictures");
          newLi.appendChild(blogImgBoxImg); // 将新建的 img 标签放到容器里
        }

        // 将发布的文本内容添加到新的的 ol 的 li 列表中中去
        $(".testBoxTitle").appendChild(newLi);

        // 清空文本框 & 上传的图片 & 展示图片预览的盒子
        $D("textarea").value = "";
        $D("file").value = "";
        $(".previewPicturesBox").innerHTML = '';
      }
    }
  </script>
</body>

</html>